/*dest/statics/javascripts/configs.js*/
(function(){var a,b;b=angular.module("jt.configsPage",[]),a=function(a,b,c,d){var e,f,g,h,i;e=d("jt.configsPage"),e("configs:%j",JT_GLOBAL.configs),f=null,g=null,angular.forEach(c.children(),function(a){var b;b=angular.element(a),b.hasClass("previewContainer")&&(f=b,angular.forEach(b.children(),function(a){angular.element(a).hasClass("content")&&(g=angular.element(a))}))}),a.configs=JT_GLOBAL.configs,a.sets=JT_GLOBAL.sets,a.error={},a.success={},a.preview={},a.selectedItems=[],a.selectedTotal=0,c.removeClass("hidden"),a.set={},a.showType="config",h=function(b){var c;a.error.preview="",c=angular.copy(b),delete c.$$hashKey,delete c._id,a.statsOptions=c,f.removeClass("hidden")},i=function(a){var b,c;b=angular.toJson(a.stats,!0),c=angular.element('<pre class="code"><code>'+b+"</code></pre>"),g.empty(),g.append(c),f.removeClass("hidden")},a.closePreview=function(){f.addClass("hidden")},a.preview=function(b,c){switch(a.preview.type=c,c){case"stats":i(b);break;default:h(b)}},a.toggleSelected=function(b){var c;b.selected?(c=a.selectedItems.indexOf(b),a.selectedItems.splice(c,1)):(b.area=1,a.selectedItems.push(b)),b.selected=!b.selected},a.edit=function(b){var c;c=function(b){var c;return c=null,angular.forEach(a.configs,function(a){a._id===b&&(c=a)}),c},angular.forEach(a.selectedItems,function(a){a.selected=!1}),a.selectedItems=[],angular.forEach(b.configs,function(b){var d;d=c(b.id),d.area=b.area,d.selected=!0,a.selectedItems.push(d)}),a.set.name=b.name,a.set.id=b._id},a.save=function(){var c,d,e,f;a.set.name&&(d={name:a.set.name},c=[],angular.forEach(a.selectedItems,function(a){return c.push({id:a._id,area:a.area})}),d.configs=c,f="/set",e=a.set.id,e&&(f+="/"+e),b.post(f,d).then(function(){a.error.save="",a.success.save="已成功保存该配置"},function(){a.success.save="",a.error.save="保存不成功"}))}},a.$inject=["$scope","$http","$element","jtDebug"],angular.module("jtApp").addRequires(["jt.configsPage"]).controller("ConfigsPageController",a)}).call(this);