/*dest/statics/services/stats.js*/
(function(){var a;a=angular.module("jt.service.stats",["jt.service.debug"]),a.factory("jtStats",["$http","$q","jtDebug",function(a,b,c){var d,e;return d=c("jt.stats"),e={getData:function(c,e){var f,g,h,i;return f={date:c.date,fill:c.fill,point:c.point},h=[],angular.forEach(c.stats,function(d){var e,g,i,j;e=b.defer(),d=angular.extend({},f,d),i="/stats?conditions="+JSON.stringify(d),g={cache:!0},(null!=(j=c.point)?j.interval:void 0)<0&&(i+="&cache=false",g.cache=!1),c.refreshInterval&&(g.cache=!1),a.get(i,g).success(function(a){angular.isArray(a)?angular.forEach(a,function(a){a.chart=d.chart}):a.chart=d.chart,e.resolve(a)}).error(function(a){e.reject(a)}),h.push(e.promise)}),i=function(a){var b;d("getData options:%j, res:%j",c,a),b=[],angular.forEach(a,function(a){angular.isArray(a)?b=b.concat(a):b.push(a)}),e(null,b)},g=function(a){d("getData options%j, err:%j",c,a),e(a)},b.all(h).then(i,g)},getKeys:function(b,c){return a.get("/collection/"+b+"/keys").success(function(a){return d("getKeys res:%j",a),c(null,a)}).error(function(a){return d("getKeys err:%j",a),c(a)})}}}])}).call(this);
/*dest/statics/directives/table.js*/
(function(){var a;a=angular.module("jt.directive.table",["jt.service.debug","jt.service.stats"]),a.directive("jtTable",["$compile","$http","jtDebug","jtStats",function(a,b,c,d){var e,f;return e=c("jt.table"),f=function(a,b){var c,d,e,f,g,h,i;return i=a.getFullYear(),f=a.getMonth()+1,10>f&&(f="0"+f),c=a.getDate()+1,10>c&&(c="0"+c),h=""+i+"-"+f+"-"+c,86400>b&&(d=a.getHours(),10>d&&(d="0"+d),e=a.getMinutes(),10>e&&(e="0"+e),h+=" "+d+":"+e),60>b&&(g=a.getSeconds(),10>g&&(g="0"+g),h+=":"+g),h},{restrict:"A",template:'<div class="jtTable"></div>',link:function(b,c,e){var g,h,i,j,k,l,m;return h=e.jtTable,g=b[h],m=b.$new(),l={index:0,order:0},m.sort=l,m.sortByIndex=function(a){l.index===a?l.order=++l.order%2:(l.index=a,l.order=0)},k=function(a,b){var c,d;c=a.index,d=a.order,b.sort(function(a,b){return a[c]>b[c]?d?1:-1:a[c]<b[c]?d?-1:1:0})},j=function(b){var d,e;e='<div class="panel panel-default"><div class="panel-heading" ng-bind="name"></div><table class="table"><thead><tr><th ng-repeat="th in theadData" ng-click="sortByIndex($index)"><span ng-bind="th"></span><i class="fa" ng-class="{\'fa-sort\' : sort.index != $index, \'fa-sort-desc\' : sort.index == $index && sort.order == 0, \'fa-sort-asc\' : sort.index == $index && sort.order == 1}"></i></th></tr></thead><tbody><tr ng-repeat="data in tableData"><td ng-repeat="td in data track by $index" ng-bind="td || 0 "></td></tr></tbody></table></div>',d=c.children("div").html(e),a(d)(b)},i=function(a){var b;return m.name=a.name||"未定义",b=c.children("div"),b.html('<div style="margin:15px"><div class="alert alert-info">正在加载数据，请稍候...</div></div>'),d.getData(a,function(c,d){var e,g,h,i,n,o,p;return c?void b.html(c.msg):(g=(null!=(p=a.point)?p.interval:void 0)||60,i={},e=[],h=[],angular.forEach(d,function(a){var b;return b=a.key,h.push(b),angular.forEach(a.values,function(a){var c,d;d=Math.floor(a.t/g)*g*1e3,c=f(new Date(d),g),i[c]||(e.push(c),i[c]={}),i[c][b]=a.v})}),e.sort(),o=["日期"].concat(h),n=[],angular.forEach(e,function(a){var b;b=[a],angular.forEach(h,function(c,d){b[d+1]=i[a][c]}),n.push(b)}),l&&k(l,n),m.theadData=o,m.tableData=n,void j(m))})},b.$watch(h,function(a){a&&i(a)}),m.$watchCollection("sort",function(a){a&&m.tableData&&k(a,m.tableData)})}}}])}).call(this);
/*dest/statics/javascripts/dashboard.js*/
(function(){var a,b;b=angular.module("jt.dashboardPage",[]),b.factory("jtSet",["$http","jtDebug",function(a,b){var c,d;return c=b("jt.jtSet"),d={get:function(b,c){return a.get("/set/"+b,{cache:!0}).success(function(a){return c(null,a)}).error(function(a){return c(a)})}}}]),a=function(a,b,c,d,e,f){var g;g=c("jt.dashboardPage"),g("start"),a.setList=JT_GLOBAL.setList,a.chartType="",a.selectedSetList=[],a.add=function(b){var c;c=a.setList[b],b=a.selectedSetList.indexOf(c),~b||(a.show(c),a.selectedSetList.push(c))},a.remove=function(b){var c;c=a.selectedSetList.indexOf(b),~c&&a.selectedSetList.splice(c,1),b.selected&&(a.configs=null,b.selected=!1)},a.show=function(b){b.selected||(angular.forEach(a.selectedSetList,function(a){a.selected=!1}),b.selected=!0,f.get(b._id,function(b,c){var d;(null!=c&&null!=(d=c.configs)?d.length:void 0)&&(a.configs=c.configs)}))},JT_GLOBAL.selectedSetId&&!function(){var b;b=-1,angular.forEach(a.setList,function(a,c){JT_GLOBAL.selectedSetId===a._id&&(b=c)}),~b&&a.add(b)}()},a.$inject=["$scope","$http","jtDebug","$log","user","jtSet"],angular.module("jtApp").addRequires(["jt.dashboardPage"]).controller("DashboardController",a)}).call(this);