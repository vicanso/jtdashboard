(function(){var a;a=angular.module("jt.service.stats",["jt.service.debug"]),a.factory("jtStats",["$http","$q","jtDebug",function(a,b,c){var d,e;return d=c("jt.stats"),e={getData:function(c,e){var f,g,h,i;return f={date:c.date,fill:c.fill,point:c.point},h=[],angular.forEach(c.stats,function(d){var e,g,i,j;e=b.defer(),d=angular.extend({},f,d),i="/stats?conditions="+JSON.stringify(d),g={cache:!0},(null!=(j=c.point)?j.interval:void 0)<0&&(i+="&cache=false",g.cache=!1),c.refreshInterval&&(g.cache=!1),a.get(i,g).success(function(a){angular.isArray(a)?angular.forEach(a,function(a){a.chart=d.chart}):a.chart=d.chart,e.resolve(a)}).error(function(a){e.reject(a)}),h.push(e.promise)}),i=function(a){var b;d("getData options:%j, res:%j",c,a),b=[],angular.forEach(a,function(a){angular.isArray(a)?b=b.concat(a):b.push(a)}),e(null,b)},g=function(a){d("getData options%j, err:%j",c,a),e(a)},b.all(h).then(i,g)},getKeys:function(b,c){return a.get("/collection/"+b+"/keys").success(function(a){return d("getKeys res:%j",a),c(null,a)}).error(function(a){return d("getKeys err:%j",a),c(a)})}}}])}).call(this);