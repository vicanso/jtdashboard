!function(){"use strict";function n(n,t){return{restrict:"E",scope:{data:"=jtData"},link:function(a,r){function e(n){var t=n.length,r=n.slice(l,t);l=t;var e=[];angular.forEach(r,function(n){var t=n.topic,a=n.msg;if(o){var r=o(a);if(!r.filter)return;a=r.msg}var l='<span class="topic">'+t+"</span>",c=i[t];c&&(a=c(a)),e.push("<p>"+l+a+"</p>")}),s.append(e.join("")),a.bottom&&s.scrollTop(Number.POSITIVE_INFINITY)}var l=0,c='<div class="ctrls input-group"><span class="input-group-addon ctrl" ng-class="{selected : filter}" ng-click="filter = !filter"><i class="glyphicon glyphicon-filter"></i></span><input type="text" class="form-control keyword" placeholder="请输入关键字" ng-model="key" /><span class="input-group-addon ctrl" ng-class="{selected : bottom}" ng-click="bottom = !bottom"><i class="glyphicon glyphicon-pushpin"></i></span></div>',o=null;a.bottom=!0,a.filter=!1,r.append(c);var s=angular.element('<div class="msgContainer"></div>');r.append(s),n(r.children())(a),a.$watchCollection("data",function(n){n&&n.length&&e(n)});var p=function(n,t){return t=t||"and",function(a){var i;i="or"===t?!1:!0;var r=a;return angular.forEach(n,function(n){var e=new RegExp("("+n+")","gi");r=r.replace(e,'<span class="key">$1</span>'),"or"===t?i||(i=r!==a):i&&(i=r!==a)}),{filter:i,msg:r}}},u=function(){var n=a.key,t=a.filter;o=n&&t?-1!==n.indexOf("||")?p(n.split("||"),"or"):-1!==n.indexOf("&&")?p(n.split("&&"),"and"):p([n]):null,l=0,s.empty(),e(a.data)},d=t.debounce(function(){a.$apply(u)},500);a.$watch("key",d),a.$watch("filter",d)}}}function t(n){var t="[HAPROXY]",a=n.indexOf(t);return-1!==a&&(n=n.substring(a+t.length)),console.dir(n),n}var a=angular.module("jtApp");a.directive("jtLog",n);var i={haproxy:t};n.$inject=["$compile","utils"]}(this);