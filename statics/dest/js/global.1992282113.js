!function(){"use strict";function e(e,t,n,o,r){function s(){var t=angular.element(angular.element("#loginDialog").html()),r=e.$new(!0);angular.extend(r,{status:"show",type:"login",modal:!0}),n(t)(r),o.append(t),r.submit=function(){a(r)},angular.forEach(["account","password"],function(e){r.$watch(e,function(){r.error=""})})}function i(){r.logout()}function a(e){if(!e.account||!e.password)return void(e.error="账号和密码均不能为空");e.submiting=!0,e.msg="正在提交，请稍候...";var t=r[e.type];t&&t(e.account,e.password).success(function(){e.destroy()}).error(function(t){e.error=t.msg||t.error||"未知异常",e.submiting=!1,e.msg=""})}function u(){c.session.status="loading",r.session().then(function(e){angular.extend(c.session,e),c.session.status="success"},function(e){c.session.error=e,c.session.status="fail"})}var c=this;c.login=s,c.logout=i,c.session={},e.$on("user",function(){u()}),u()}var t=["LocalStorageModule","jt.service.debug","jt.service.utils","jt.service.httpLog","jt.directive.widget","jt.service.user"],n=angular.module("jtApp",t);n.addRequires=function(e){angular.isArray(e)||(e=[e]);var t=n.requires;return angular.forEach(e,function(e){~t.indexOf(e)||t.push(e)}),this},n.config(["localStorageServiceProvider",function(e){e.prefix="jt"}]).config(["$httpProvider",function(e){e.defaults.timeout=5e3,e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.interceptors.push("httpLog")}]).config(["$provide",function(e){var t=["$log","$injector",function(e,t){return function(n,o){if("development"===CONFIG.env)alert(n.message),e.error.apply(e,arguments);else{var r=t.get("$http");r.post("/exception?httplog=false",{message:n.message,stack:n.stack,cause:o})}}}];e.decorator("$exceptionHandler",t)}]),n.run(["$http","$timeout","$window","debug",function(e,t,n,o){TIMING.end("js"),o=o("app.run");var r=function(){var t=angular.extend({timeline:TIMING.getLogs(),view:{width:n.screen.width,height:n.screen.height}},n.performance);e.post("/statistics",t)};if(n.onload=function(){r()},"development"===CONFIG.env){var s=5e3,i=function(){var e=0,n=function(t){if(t.data().hasOwnProperty("$scope")){var o=t.data().$scope.$$watchers;o&&o.length&&(e+=o.length)}angular.forEach(t.children(),function(e){n(angular.element(e))})};n(angular.element(document.body)),o("watcher total:"+e),t(function(){i()},s)};t(function(){i()},i)}}]),n.controller("AppController",e),e.$inject=["$scope","$http","$compile","$element","user"]}(this);